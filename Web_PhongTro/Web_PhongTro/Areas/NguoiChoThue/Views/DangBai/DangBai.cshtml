<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đăng tin mới</title>
    <link rel="stylesheet" href="~/Areas/NguoiChoThue/Content/baidang.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

</head>
<body>
    <div class="container">
        <header>
            <h1 style="text-align: center;">Đăng tin mới</h1>
        </header>
        <div class="form-container">
            <nav class="sidebar">
                <div class="user-info">
                    <a href="#" class="clearfix">
                        <div class="user_avatar"><img src="~/Contents/Images/user.jpg"></div>
                        <div class="user_meta">
                            <div class="inner">
                                <div class="user_name">Người Dùng</div>
                                <div class="user_verify" style="color: #555; font-size: 0.9rem;">Mã số</div>
                            </div>
                        </div>
                    </a>
                    <ul>
                        <li><span>Mã thành viên:</span> <span style="font-weight: 700;"> 145753</span></li>
                    </ul>
                    <ul class="nav nav-sidebar">
                        <li class="nav-item">
                            <a class="nav-link " href="quanlibaidang.html">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                                Quản lý tin đăng
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link " href="Thongtincanhan.html">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>
                                Sửa thông tin cá nhân
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="LienHe.html">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-message-circle"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>
                                Liên hệ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link js-user-logout" href="quanlibaidang.html">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-log-out"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
                                Thoát
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>
        <div class="ad-info">
            <form asp-action="SaveDiaChi" asp-controller="DangBai" method="post">
                <div class="col-md-8">
                    <div class="row">
                        <div class="col-md-12">
                            <h1>Địa chỉ cho thuê</h1>
                        </div>
                    </div>
                    @Html.Action("DanhSachDiaChi", "DangBai")
                </div>
                <div class="row">
                    <div class="col-md-3">
                        <div class="form-group">
                            <label for="street_number" class="col-form-label">Số nhà</label>
                            <input type="text" class="form-control js-input-street-number" name="street_number" id="street_number" value="">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="form-group">
                            <label for="diachi" class="col-form-label">Địa chỉ chính xác</label>
                            <input type="text" readonly="" class="form-control" name="dia_chi" id="diachi" required="" data-msg-required="Chưa chọn khu vực đăng tin">
                        </div>
                    </div>
                </div>
                <div class="form-group row mt-5">
                    <div class="col-md-12">
                        <h3>Thông tin mô tả</h3>
                    </div>
                </div>
                <div class="form-group row mt-3">
                    <label for="post_cat" class="col-md-12 col-form-label">Loại chuyên mục</label>
                    <div class="col-md-6">
                        <select class="form-control" id="post_cat" name="loai_chuyen_muc" required="" data-msg-required="Chưa chọn loại chuyên mục">
                            <option value="">-- Chọn loại danh mục --</option>
                            <option value="1">Phòng trọ, nhà trọ</option>
                            <option value="2">Nhà thuê nguyên căn</option>
                            <option value="3">Phòng Trọ Ghép</option>
                            <option value="4">Mặt Bằng Kinh Doanh</option>
                            <option value="5">Căn Hộ Mini</option>
                            <option value="6">Văn Phòng</option>
                            <option value="6">Chung Cư</option>
                        </select>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="post_title" class="col-md-12 col-form-label">Tiêu đề</label>
                    <div class="col-md-12">
                        <input type="text" class="form-control js-title" name="tieu_de" id="post_title" value="" minlength="30" maxlength="120" required="" data-msg-required="Tiêu đề không được để trống" data-msg-minlength="Tiêu đề quá ngắn" data-msg-maxlength="Tiêu đề quá dài">
                    </div>
                </div>
                <div class="form-group row">
                    <label for="post_content" class="col-md-12 col-form-label">Nội dung mô tả</label>
                    <div class="col-md-12">
                        <textarea class="form-control js-content" name="noi_dung" id="post_content" rows="10" required="" minlength="100" data-msg-required="Bạn chưa nhập nội dung" data-msg-minlength="Nội dung tối thiểu 100 kí tự"></textarea>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="phone" class="col-md-12 col-form-label">Thông tin liên hệ</label>
                    <div class="col-md-6">
                        <div class="input-group mb-3">
                            <input id="ten_lien_he" type="text" name="ten_lien_he" class="form-control" readonly="readonly" required="" data-msg-required="Tên liên hệ">
                        </div>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="phone" class="col-md-12 col-form-label">Điện thoại</label>
                    <div class="col-md-6">
                        <div class="input-group mb-3">
                            <input id="phone" type="number" name="phone" class="form-control" readonly="readonly" required="" data-msg-required="Số điện thoại">
                        </div>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="giachothue" class="col-md-12 col-form-label">Giá cho thuê</label>
                    <div class="col-md-6">
                        <div class="input-group">
                            <input id="giachothue" name="gia" pattern="[0-9.]+" type="text" class="form-control js-gia-cho-thue" required="" data-msg-required="Bạn chưa nhập giá phòng" data-msg-min="Giá phòng chưa đúng">
                            <div class="input-group-append">

                                <select class="form-control js-unit valid" name="don_vi" id="don_vi" aria-invalid="false">
                                    <option value="0">đồng/tháng</option>
                                    <option value="1">đồng/m2/tháng</option>
                                </select>
                            </div>
                        </div>
                        <!-- <small class="form-text text-muted">Nhập đầy đủ số, ví dụ 1 triệu thì nhập là 1000000</small> -->
                    </div>
                    <label for="text_giachothue" id="text_giachothue" class="col-sm-12 control-label js-number-text" style="color: red;"></label>
                </div>
                <div class="form-group row">
                    <label for="post_acreage" class="col-md-12 col-form-label">Diện tích</label>
                    <div class="col-md-6">
                        <div class="input-group mb-3">
                            <input id="post_acreage" type="number" attern="[0-9.]+" name="dien_tich" max="1000" class="form-control valid" required="" data-msg-required="Bạn chưa nhập diện tích" aria-invalid="false">
                            <div class="input-group-append">
                                <span class="input-group-text">m<sup>2</sup></span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="doi_tuong" class="col-md-12 col-form-label">Đối tượng cho thuê</label>
                    <div class="col-md-6">
                        <div class="input-group mb-3">
                            <select class="form-control valid" id="post_cat" name="doi_tuong" aria-invalid="false">
                                <option value="Tất cả">-- Tất cả --</option>
                                <option value="Nam">Nam</option>
                                <option value="Nữ">Nữ</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="form-group row mt-5">
                    <div class="col-md-12">
                        <h3>Hình ảnh</h3>
                    </div>
                </div>
                <div class="image-upload-container">
                    <div class="image-upload-box">
                        <label for="image-upload" class="image-upload-label">
                            <i class="fas fa-plus"></i>
                            <i class="bi bi-images"></i>
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-upload" viewBox="0 0 16 16">
                                <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5" />
                                <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708z" />
                            </svg>
                            <span>Thêm ảnh</span>
                        </label>
                        <input type="file" id="image-upload" class="image-upload-input" accept="image/*" multiple>
                    </div>
                    <div class="uploaded-images">
                        <!-- Các hình ảnh được tải lên sẽ được hiển thị ở đây -->
                    </div>
                    <script>
                        const uploadInput = document.getElementById('image-upload');
                        const uploadedImagesContainer = document.querySelector('.uploaded-images');

                        uploadInput.addEventListener('change', function () {
                            const files = Array.from(uploadInput.files);

                            files.forEach(file => {
                                const reader = new FileReader();

                                reader.onload = function (e) {
                                    const img = document.createElement('img');
                                    img.src = e.target.result;
                                    img.classList.add('uploaded-image');

                                    const deleteButton = document.createElement('button');
                                    deleteButton.innerHTML = 'Xóa';
                                    deleteButton.classList.add('delete-button');
                                    deleteButton.addEventListener('click', function () {
                                        uploadedImagesContainer.removeChild(imageContainer);
                                    });

                                    const imageContainer = document.createElement('div');
                                    imageContainer.classList.add('image-container');
                                    imageContainer.appendChild(img);
                                    imageContainer.appendChild(deleteButton);

                                    uploadedImagesContainer.appendChild(imageContainer);
                                };

                                reader.readAsDataURL(file);
                            });
                        });
                    </script>
                </div>
                <div class="form-group row mt-5">
                    <div class="col-md-12">
                        <button type="button" class="btn btn-primary mt-3" onclick="saveDiaChi()">Tiếp tục</button>
                    </div>
                </div>

        </div>
        </form>
    </div>
    <div class="additional-info">
        <div class="card mb-5" style="color: #856404; background-color: #fff3cd; border-color: #ffeeba;">
            <div class="card-body">
                <h4 class="card-title">Lưu ý khi đăng tin</h4>
                <ul>
                    <li style="list-style-type: square; margin-left: 15px;">Nội dung phải viết bằng tiếng Việt có dấu</li>
                    <li style="list-style-type: square; margin-left: 15px;">Tiêu đề tin không dài quá 100 kí tự</li>
                    <li style="list-style-type: square; margin-left: 15px;">Các bạn nên điền đầy đủ thông tin vào các mục để tin đăng có hiệu quả hơn.</li>
                    <li style="list-style-type: square; margin-left: 15px;">Để tăng độ tin cậy và tin rao được nhiều người quan tâm hơn, hãy sửa vị trí tin rao của bạn trên bản đồ bằng cách kéo icon tới đúng vị trí của tin rao.</li>
                    <li style="list-style-type: square; margin-left: 15px;">Tin đăng có hình ảnh rõ ràng sẽ được xem và gọi gấp nhiều lần so với tin rao không có ảnh. Hãy đăng ảnh để được giao dịch nhanh chóng!</li>
                </ul>
            </div>
        </div>
    </div>
    </div>
    </div>
    <script>
       $(document).ready(function () {
            $('#district_id').prop('disabled', true);
            $('#phuongxa').prop('disabled', true);

            // When a province is selected
            $('#province_id').change(function () {
                var selectedProvince = $(this).val();

                if (selectedProvince !== "") {
                    $('#district_id').prop('disabled', false);

                    // TODO: Make an AJAX call to load districts for the selected province
                    // Example:
                    // $.ajax({
                } else {
                    $('#district_id').prop('disabled', true).val('');
                    $('#phuongxa').prop('disabled', true).val('');
                }

                // Disable the ward dropdown since no district is selected yet
                $('#phuongxa').prop('disabled', true);
            });

            // When a district is selected
            $('#district_id').change(function () {
                var selectedDistrict = $(this).val();

                if (selectedDistrict !== "") {
                    // Enable the ward dropdown
                    $('#phuongxa').prop('disabled', false);
                    $.ajax({
                        url: '@Url.Action("GetWardsByDistrict", "DangBai")',
                        type: 'GET',
                        data: { district: selectedDistrict },
                        success: function (data) {
                            $('#phuongxa').prop('disabled', false);
                            $('#phuongxa').html(''); // Clear current options
                            $('#phuongxa').append('<option value="">-- Chọn Phường/Xã --</option>'); // Default option

                            // Populate ward dropdown with the new data
                            $.each(data, function (index, ward) {
                                $('#phuongxa').append('<option value="' + ward + '">' + ward + '</option>');
                            });
                        }
                    });


                } else {
                    // If no district is selected, disable the ward dropdown
                    $('#phuongxa').prop('disabled', true).val('');
                }
            });
        });

    </script>
    </div>
</body>
</html>
